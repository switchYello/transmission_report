# transmission_report

## transmission辅种情况分析脚本

脚本会调用transmission的接口，获取当前所有种子，按照文件名称大小进行分组，以表格形式展示。  
从输出能够看出每个种子在每个站点的做种情况，可以辅助我们决策删种，执行脚本后在控制台中输出如下效果。

```shell
user@debian:/opt/transmission_report/src$ bash start.sh -utr -ptr -c10
┌───────┬────────────────────────────────────────────────────────────────────────────────────────────────┬────────────┬──────────┬──────────┐
│ index │                                              name                                              │ trackCount │   size   │ sitename │
├───────┼────────────────────────────────────────────────────────────────────────────────────────────────┼────────────┼──────────┼──────────┤
│   0   │                脱口秀大会.Rock.&.Roast.S06.2024.2160p.WEB-DL.H265.DDP2.0-ADWeb                   │     2      │ 56.23 GB │ hdkylin  │
│       │                                                                                                │            │          │ m-team   │
└───────┴────────────────────────────────────────────────────────────────────────────────────────────────┴────────────┴──────────┴──────────┘
│   1   │ 边水往事.Escape.from.the.Trilateral.Slopes.S01.2024.1080p.WEB-DL.HEVC.10bit.HDR.AAC.2.0-HDKWeb  │     3      │ 48.82 GB │ hdkyl    │
│       │                                                                                                │            │          │ hdkylin  │
│       │                                                                                                │            │          │ m-team   │
└───────┴────────────────────────────────────────────────────────────────────────────────────────────────┴────────────┴──────────┴──────────┘
│   2   │    异形前传：普罗米修斯 Prometheus 2012 UHD Blu-ray 2160p HDR HEVC DTS-HD MA 7.1-Pete@HDSky        │     4      │ 47.62 GB │ cyanbug  │
│       │                                                                                                │            │          │ hdkyl    │
│       │                                                                                                │            │          │ hdkylin  │
│       │                                                                                                │            │          │ m-team   │
└───────┴────────────────────────────────────────────────────────────────────────────────────────────────┴────────────┴──────────┴──────────┘
│   3   │               American.Horror.Story.S01.2011.Disney+.WEB-DL.1080p.H264.DDP-HDCTV               │     2      │ 31.95 GB │ cyanbug  │
│       │                                                                                                │            │          │ m-team   │
└───────┴────────────────────────────────────────────────────────────────────────────────────────────────┴────────────┴──────────┴──────────┘
│   4   │            Gambling.Apocalypse.Kaiji.S02.2011.1080p.BluRay.x265.10bit.FLAC.2.0-ADE             │     2      │ 29.68 GB │ cyanbug  │
│       │                                                                                                │            │          │ hdkylin  │
└───────┴────────────────────────────────────────────────────────────────────────────────────────────────┴────────────┴──────────┴──────────┘
│   5   │            Gambling.Apocalypse.Kaiji.S01.2007.1080p.BluRay.x265.10bit.FLAC.2.0-ADE             │     2      │ 27.07 GB │ cyanbug  │
│       │                                                                                                │            │          │ hdkylin  │
└───────┴────────────────────────────────────────────────────────────────────────────────────────────────┴────────────┴──────────┴──────────┘
│   6   │                胆小鬼.Nobody.Knows.S01.2022.1080p.NowPlay.WEB-DL.H264.AAC-HHWEB                 │     4      │ 26.83 GB │ cyanbug  │
│       │                                                                                                │            │          │ hdkyl    │
│       │                                                                                                │            │          │ hdkylin  │
│       │                                                                                                │            │          │ m-team   │
└───────┴────────────────────────────────────────────────────────────────────────────────────────────────┴────────────┴──────────┴──────────┘
│   7   │             火星救援.The.Martian.2015.BluRay.2160p.x265.10bit.HDR.4Audio.mUHD-FRDS              │     1      │ 24.96 GB │ kufei    │
└───────┴────────────────────────────────────────────────────────────────────────────────────────────────┴────────────┴──────────┴──────────┘
│   8   │   闻香识女人[简繁英字幕].Scent.of.a.Woman.1992.1080p.BluRay.x265.10bit.DTS-HD.MA.5.1-ParkHD        │     1      │ 21.89 GB │ kufei    │
└───────┴────────────────────────────────────────────────────────────────────────────────────────────────┴────────────┴──────────┴──────────┘
│   9   │              山花烂漫时.Shan.Hua.Lan.Man.Shi.S01.2024.2160p.WEB-DL.H265.AAC-HHWEB                │     2      │ 20.71 GB │ cyanbug  │
│       │                                                                                                │            │          │ hdkylin  │
└───────┴────────────────────────────────────────────────────────────────────────────────────────────────┴────────────┴──────────┴──────────┘
```

## 安装
> 需要python环境，依赖python的venv组件，如果安装时缺少相关依赖请自行安装好。

1. 将本项目从github下载到服务器上,放在某个文件夹下
> git clone https://github.com/switchYello/transmission_report.git

2. 执行如下命令初始化python venv环境
```shell
#进入src目录
cd src
#创建venv环，此时会创建一个隐藏文件夹.venv
python3 -m venv .venv
#激活venv环境
source .venv/bin/activate
#venv环境下安装必要的组件
python3 -m pip install -r requirements.txt
#退出虚拟环境
deactivate
#加执行权限
chmod u+x start.sh
```

3. 如果后续有更新的话直接 `git pull -f https://github.com/switchYello/transmission_report.git`,不过应该也不会更新了


## 使用
使用时进入到脚本所在的文件夹下，直接执行 `bash start.sh` 即可使用默认参数运行一次，控制台可输出上述报表。

参数：
可指定参数有下面这些,可以通过别名的方式初始好参数这样以后就不用输入参数了。  

> 只展示大于500MB的，从大到小排序的前50个种子，账号密码都是tr  
> bash start.sh -h http://127.0.0.1:9091 -u tr -p tr -m 500 -c 50

```text
-h 指定tr地址,需要带前面的http，默认http://127.0.0.1:9091
-u 指定用户名 默认空字符串
-p 指定密码 默认空字符串
-m 小于该大小的种子不显示,单位为MB 默认0全部展示
-c 列表展示前多少个种子 默认2000,不需要太多，不然一页看不过来
```

## 卸载
因为使用的venv环境，直接将git对应的文件夹全部删除即可。


## 小技巧，使用别名方便使用
```text
在用户目录下的隐藏文件.baserc文件中增加如下行（参数和路径自行修改）
alias reporttr='bash /path_to_source/src/start.sh -u tr -p tr -c200'
```
保存后执行 `source .baserc`

为这行脚本定义一个别名，后面无论在哪个目录下直接执行`reporttr`都能调用脚本了

