# transmission_report

## transmission辅种情况分析脚本

脚本会调用transmission的接口，获取当前所有种子，按照文件名称大小进行分组，以表格形式展示。  
从输出能够看出每个种子在每个站点的做种情况，可以辅助我们决策删种，执行脚本后在控制台中输出如下效果。

```shell
user@debian:/opt/transmission_report/src$ bash start.sh -utr -ptr -c10
┌──────┬────────────────────────────────────────────────────────────────────────────────────────────────┬──────────┬───────────┬────────────────────────────────────┐
│ 序号 │                                              文件名                                              │  辅种数量 │   文件大小  │  站点名称(最后活跃时间)                           │
├──────┼────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼────────────────────────────────────┤
│  0   │                 脱口秀大会.Rock.&.Roast.S06.2024.2160p.WEB-DL.H265.DDP2.0-ADWeb                  │     2    │  56.23 GB │ hdkylin (2024-10-28 17:59:25)      │
│      │                                                                                                │          │           │ m-team (2024-10-29 15:10:47)       │
└──────┴────────────────────────────────────────────────────────────────────────────────────────────────┴──────────┴───────────┴────────────────────────────────────┘
│  1   │  边水往事.Escape.from.the.Trilateral.Slopes.S01.2024.1080p.WEB-DL.HEVC.10bit.HDR.AAC.2.0-HDKWeb  │     3    │  48.82 GB │ hdkyl (2024-10-29 14:02:59)       │
│      │                                                                                                │          │           │ hdkylin (2024-10-29 14:02:59)      │
│      │                                                                                                │          │           │ m-team (1970-01-01 08:00:00)       │
└──────┴────────────────────────────────────────────────────────────────────────────────────────────────┴──────────┴───────────┴────────────────────────────────────┘
│  2   │     异形前传：普罗米修斯 Prometheus 2012 UHD Blu-ray 2160p HDR HEVC DTS-HD MA 7.1-Pete@HDSky       │    4     │  47.62 GB │ cyanbug (2024-10-28 21:40:31)      │
│      │                                                                                                │          │           │ hdkyl (2024-10-29 20:59:35)        │
│      │                                                                                                │          │           │ hdkylin (2024-10-29 20:59:35)      │
│      │                                                                                                │          │           │ m-team (2024-10-28 12:46:15)       │
└──────┴────────────────────────────────────────────────────────────────────────────────────────────────┴──────────┴───────────┴────────────────────────────────────┘
│  3   │                American.Horror.Story.S01.2011.Disney+.WEB-DL.1080p.H264.DDP-HDCTV              │    2     │  31.95 GB │ cyanbug (2024-10-25 11:54:16)      │
│      │                                                                                                │          │           │ m-team (2024-10-26 17:20:22)       │
└──────┴────────────────────────────────────────────────────────────────────────────────────────────────┴──────────┴───────────┴────────────────────────────────────┘
│  4   │             Gambling.Apocalypse.Kaiji.S02.2011.1080p.BluRay.x265.10bit.FLAC.2.0-ADE            │    2     │  29.68 GB │ cyanbug (1970-01-01 08:00:00)      │
│      │                                                                                                │          │           │ hdkylin (1970-01-01 08:00:00)      │
└──────┴────────────────────────────────────────────────────────────────────────────────────────────────┴──────────┴───────────┴────────────────────────────────────┘
│  5   │             Gambling.Apocalypse.Kaiji.S01.2007.1080p.BluRay.x265.10bit.FLAC.2.0-ADE            │    2     │  27.07 GB │ cyanbug (1970-01-01 08:00:00)      │
│      │                                                                                                │          │           │ hdkylin (1970-01-01 08:00:00)      │
└──────┴────────────────────────────────────────────────────────────────────────────────────────────────┴──────────┴───────────┴────────────────────────────────────┘
│  6   │                 胆小鬼.Nobody.Knows.S01.2022.1080p.NowPlay.WEB-DL.H264.AAC-HHWEB                │    4     │  26.83 GB │ cyanbug (2024-10-21 12:23:59)      │
│      │                                                                                                │          │           │ hdkyl (2024-10-25 16:41:19)        │
│      │                                                                                                │          │           │ hdkylin (2024-10-25 16:41:19)      │
│      │                                                                                                │          │           │ m-team (2024-10-28 15:51:15)       │
└──────┴────────────────────────────────────────────────────────────────────────────────────────────────┴──────────┴───────────┴────────────────────────────────────┘
```

## 安装
> **脚本需要python环境，依赖python的venv组件，如果安装时缺少相关依赖请自行安装好。**

1. 将本项目从github下载到服务器上,放在某个文件夹下
```shell
git clone https://github.com/switchYello/transmission_report.git
```

2. 执行如下命令初始化python venv环境
```shell
#进入src目录
cd src
#创建venv环，此时会创建一个隐藏文件夹.venv
python3 -m venv .venv
#激活venv环境
source .venv/bin/activate
#venv环境下安装必要的组件
python3 -m pip install -r requirements.txt
#退出虚拟环境
deactivate
#加执行权限
chmod u+x start.sh
```

3. 如果后续有更新的话使用git重新拉代码,不过应该也不需要更新了
```shell
git pull -f https://github.com/switchYello/transmission_report.git
```

## 使用
使用时进入到脚本所在的文件夹下，直接执行 `bash start.sh` 即可使用默认参数运行一次，控制台可输出上述报表。

参数：
```text
-h 指定tr地址,需要带前面的http，默认http://127.0.0.1:9091
-u 指定用户名 默认空字符串
-p 指定密码 默认空字符串
-m 小于该大小的种子不显示,单位为MB 默认0全部展示
-c 列表展示前多少个种子 默认2000,不需要太多，不然一页看不过来
```

事例:  
```text
只展示大于500MB的，从大到小排序的前50个种子，账号密码都是tr
bash start.sh -h http://127.0.0.1:9091 -u tr -p tr -m 500 -c 50
```


## 卸载
因为使用的venv环境，直接将git对应的文件夹全部删除即可。  


## 小技巧，使用别名方便使用
```text
在用户目录下的隐藏文件.baserc文件中增加如下行（参数和路径自行修改）
alias reporttr='bash /path_to_source/src/start.sh -u tr -p tr -c200'

保存后执行 `source .baserc`
这里为这行脚本定义一个别名，后面无论在哪个目录下直接执行`reporttr`都能调用脚本了
```
